<!DOCTYPE html><html lang="en" class="library-layout-active"> <head><meta charset="UTF-8"><meta name="description" content="A knowledge library for the school"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/png" href="/images/template-logo.png"><meta name="generator" content="Astro v5.8.0"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.CtSceO8m.js"></script><title>Mathematical Concepts Example | [Your Library Name]</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_astro/_slug_.BZQEDgqw.css">
<link rel="stylesheet" href="/_astro/about.FgMu-8H3.css">
<style>.book-detail[data-astro-cid-rnby4x42]{padding:20px;background-color:#fff;border-radius:8px;box-shadow:0 2px 10px #0000001a}.book-detail[data-astro-cid-rnby4x42] h1[data-astro-cid-rnby4x42]{margin-top:0;margin-bottom:.5rem;font-size:2rem;color:#333}.author[data-astro-cid-rnby4x42]{font-style:italic;color:#555;margin-bottom:1rem}.summary[data-astro-cid-rnby4x42]{margin-bottom:1.5rem;line-height:1.6}.pdf-embed-container[data-astro-cid-rnby4x42]{margin-top:20px;border:1px solid #ddd;height:75vh;display:flex;flex-direction:column}.pdf-embed-container[data-astro-cid-rnby4x42]>.pdf-viewer-container{flex-grow:1;min-height:0}
</style></head> <body> <nav data-astro-cid-5blmo7yk> <div class="nav-container" data-astro-cid-5blmo7yk> <div class="logo" data-astro-cid-5blmo7yk> <img src="/images/template-logo.png" alt="[Your Library Name] Logo" class="navbar-logo-img" data-astro-cid-5blmo7yk> <a href="/" data-astro-cid-5blmo7yk>[Your Library Name]</a> </div> <button class="hamburger" aria-label="Toggle menu" aria-expanded="false" data-astro-cid-5blmo7yk> <span class="hamburger-box" data-astro-cid-5blmo7yk> <span class="hamburger-inner" data-astro-cid-5blmo7yk></span> </span> </button> <ul class="nav-links" data-astro-cid-5blmo7yk> <li data-astro-cid-5blmo7yk><a href="/" data-astro-cid-5blmo7yk>Home</a></li> <li data-astro-cid-5blmo7yk><a href="/library" class="active" data-astro-cid-5blmo7yk>Library</a></li> <li data-astro-cid-5blmo7yk><a href="/about" data-astro-cid-5blmo7yk>About</a></li> <li data-astro-cid-5blmo7yk><a href="/contact" data-astro-cid-5blmo7yk>Contact</a></li> <!-- Theme toggle in mobile menu - using same style as desktop --> <li class="mobile-theme-toggle" data-astro-cid-5blmo7yk> <button id="theme-toggle-mobile" class="theme-toggle theme-toggle-mobile" aria-label="Toggle dark mode" title="Toggle dark/light mode" data-astro-cid-5blmo7yk> <span class="theme-icon light-icon" data-astro-cid-5blmo7yk>‚òÄÔ∏è</span> <span class="theme-icon dark-icon" data-astro-cid-5blmo7yk>üåô</span> </button> </li> </ul> <!-- Global Dark Mode Toggle - Desktop Only --> <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark/light mode" data-astro-cid-5blmo7yk> <span class="theme-icon light-icon" data-astro-cid-5blmo7yk>‚òÄÔ∏è</span> <span class="theme-icon dark-icon" data-astro-cid-5blmo7yk>üåô</span> </button> </div> </nav> <script type="module">function g(){const e=document.querySelector(".hamburger"),t=document.querySelector(".nav-links");if(e&&t){e.replaceWith(e.cloneNode(!0));const n=document.querySelector(".hamburger");n.addEventListener("click",()=>{const o=n.getAttribute("aria-expanded")==="true"||!1;n.setAttribute("aria-expanded",!o),t.classList.toggle("is-active"),n.classList.toggle("is-active")})}}function a(){const e=document.getElementById("theme-toggle"),t=document.getElementById("theme-toggle-mobile"),n=localStorage.getItem("theme")||"light";m(n),e&&(e.replaceWith(e.cloneNode(!0)),document.getElementById("theme-toggle").addEventListener("click",()=>{i()})),t&&(t.replaceWith(t.cloneNode(!0)),document.getElementById("theme-toggle-mobile").addEventListener("click",()=>{i();const c=document.querySelector(".nav-links"),l=document.querySelector(".hamburger");c&&l&&(c.classList.remove("is-active"),l.classList.remove("is-active"),l.setAttribute("aria-expanded","false"))}))}function i(){const t=(document.documentElement.getAttribute("data-theme")||"light")==="light"?"dark":"light";m(t),localStorage.setItem("theme",t)}function m(e){document.documentElement.setAttribute("data-theme",e);const t=document.getElementById("theme-toggle"),n=document.getElementById("theme-toggle-mobile");t&&t.classList.toggle("dark-active",e==="dark"),n&&n.classList.toggle("dark-active",e==="dark")}g();a();document.addEventListener("astro:page-load",()=>{g(),a()});</script>  <button class="sidebar-toggle" aria-label="Toggle sidebar" aria-expanded="false"> <span class="hamburger-box"> <span class="hamburger-inner"></span> </span> </button> <div class="main-container"> <aside id="sidebar" data-astro-cid-ssfzsv2f> <h4 data-astro-cid-ssfzsv2f>Library Navigation</h4> <ul data-astro-cid-ssfzsv2f> <li data-astro-cid-ssfzsv2f><a href="/library/" class="sidebar-nav-item" data-astro-cid-ssfzsv2f>Welcome</a></li> <li class="collapsible-category is-expanded" data-category-path="/library/category1/" data-astro-cid-ssfzsv2f> <div class="category-header" data-astro-cid-ssfzsv2f> <span class="dropdown-indicator" data-astro-cid-ssfzsv2f> <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" data-astro-cid-ssfzsv2f> <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" data-astro-cid-ssfzsv2f></path> </svg> </span> <a href="/library/category1/" class="category-title-link" data-astro-cid-ssfzsv2f> Category 1 </a> </div> <ul class="submenu" data-astro-cid-ssfzsv2f> <li data-astro-cid-ssfzsv2f> <a href="/library/category1/introduction-to-category1" data-astro-cid-ssfzsv2f> Introduction to Category 1 </a> </li><li data-astro-cid-ssfzsv2f> <a href="/library/category1/mathematics-example" data-astro-cid-ssfzsv2f> Mathematical Concepts Example </a> </li> </ul> </li><li class="collapsible-category" data-category-path="/library/category2/" data-astro-cid-ssfzsv2f> <div class="category-header" data-astro-cid-ssfzsv2f> <span class="dropdown-indicator" data-astro-cid-ssfzsv2f> <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" data-astro-cid-ssfzsv2f> <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" data-astro-cid-ssfzsv2f></path> </svg> </span> <a href="/library/category2/" class="category-title-link" data-astro-cid-ssfzsv2f> Category 2 </a> </div> <ul class="submenu" data-astro-cid-ssfzsv2f> <li data-astro-cid-ssfzsv2f> <a href="/library/category2/working-with-articles" data-astro-cid-ssfzsv2f> Working with Articles in Category 2 </a> </li> </ul> </li><li class="collapsible-category" data-category-path="/library/category3/" data-astro-cid-ssfzsv2f> <div class="category-header" data-astro-cid-ssfzsv2f> <span class="dropdown-indicator" data-astro-cid-ssfzsv2f> <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" data-astro-cid-ssfzsv2f> <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" data-astro-cid-ssfzsv2f></path> </svg> </span> <a href="/library/category3/" class="category-title-link" data-astro-cid-ssfzsv2f> Category 3 </a> </div> <ul class="submenu" data-astro-cid-ssfzsv2f> <li data-astro-cid-ssfzsv2f> <a href="/library/category3/advanced-guide-example" data-astro-cid-ssfzsv2f> Advanced Guide: Building Your Content Strategy </a> </li> </ul> </li><li data-astro-cid-ssfzsv2f> <a href="/library/category4/" class="sidebar-nav-item category-title-like" data-astro-cid-ssfzsv2f> Category 4 </a> </li> </ul> </aside>  <script>(function(){const currentPage = "/library/category1/mathematics-example/";

  document.addEventListener('DOMContentLoaded', () => {
    const categoryItems = document.querySelectorAll('.collapsible-category');

    categoryItems.forEach(item => {
      const header = item.querySelector('.category-header');
      const titleLink = item.querySelector('.category-title-link');
      // const categoryPath = item.dataset.categoryPath; // Already used by SSR for initial state

      if (header) {
        header.addEventListener('click', (event) => {
          // Determine if the click was on the title link itself or elsewhere in the header (e.g., indicator)
          const isTitleLinkClicked = titleLink && titleLink.contains(event.target);

          if (isTitleLinkClicked) {
            // Clicked directly on the category title link
            if (currentPage === titleLink.getAttribute('href')) {
              // If on the category's main page, toggle dropdown and prevent navigation
              event.preventDefault();
              item.classList.toggle('is-expanded');
            } else {
              // If on a different page, allow default navigation to the category page.
              // The page will reload, and server-side logic will set the 'is-expanded' state.
              return; // Do nothing here, let the link navigate
            }
          } else {
            // Clicked on the header but not directly on the title link (e.g., on indicator or padding)
            // Always toggle the dropdown in this case.
            item.classList.toggle('is-expanded');
          }
        });
      }
    });
  });
})();</script> <main class="content-area"> <div class="content-wrapper library-content-wrapper book-detail-active">  <article class="book-detail" data-astro-cid-rnby4x42> <h1 data-astro-cid-rnby4x42>Mathematical Concepts Example</h1> <p class="author" data-astro-cid-rnby4x42>By: Library Author</p> <p class="summary" data-astro-cid-rnby4x42>An example document demonstrating proper mathematical formatting for LaTeX/PDF generation using the AI prompt conventions.</p> <div class="pdf-embed-container" data-astro-cid-rnby4x42> <div id="pdf-viewer-container" class="pdf-viewer-container" data-pdf-url="/pdfs/category1/mathematics-example.pdf" data-astro-cid-v6ggcyrl> <div class="canvas-wrapper" data-astro-cid-v6ggcyrl> <canvas id="pdf-canvas" style="display: none;" data-astro-cid-v6ggcyrl></canvas> <div class="loading-spinner" data-astro-cid-v6ggcyrl></div> </div> <div class="pdf-controls" data-astro-cid-v6ggcyrl> <button id="prev-page" title="Previous Page" data-astro-cid-v6ggcyrl> <span class="icon" data-astro-cid-v6ggcyrl><</span> <span class="text" data-astro-cid-v6ggcyrl>Previous</span> </button> <div id="page-indicator" class="page-indicator" title="Go to Page" data-astro-cid-v6ggcyrl> <span id="page-num-display" data-astro-cid-v6ggcyrl></span>&nbsp;/&nbsp;<span id="page-count-display" data-astro-cid-v6ggcyrl></span> </div> <div id="page-navigation-group" style="display: none;" data-astro-cid-v6ggcyrl> <div id="page-input-container" class="page-input-container" data-astro-cid-v6ggcyrl> <input type="number" id="page-input" min="1" data-astro-cid-v6ggcyrl> <button id="goto-page-btn" data-astro-cid-v6ggcyrl>Go</button> <span id="page-input-error-icon" class="page-input-error-icon" style="display: none;" data-astro-cid-v6ggcyrl>&#9432;</span> </div> </div> <button id="next-page" title="Next Page" data-astro-cid-v6ggcyrl> <span class="icon" data-astro-cid-v6ggcyrl>></span> <span class="text" data-astro-cid-v6ggcyrl>Next</span> </button> <span class="spacer" data-astro-cid-v6ggcyrl></span> <button id="zoom-out" class="zoom-button" title="Zoom Out" data-astro-cid-v6ggcyrl>-</button> <span id="zoom-level" class="zoom-level-display" data-astro-cid-v6ggcyrl>100%</span> <button id="zoom-in" class="zoom-button" title="Zoom In" data-astro-cid-v6ggcyrl>+</button> <span class="spacer" data-astro-cid-v6ggcyrl></span> <button id="fullscreen-btn" title="Toggle Fullscreen" data-astro-cid-v6ggcyrl> <span class="icon" data-astro-cid-v6ggcyrl>&#x2922;</span> <span class="text" style="display: none;" data-astro-cid-v6ggcyrl>Full Screen</span> </button> <!-- Hamburger Menu Button --> <button id="menu-btn" class="menu-button" title="More Options" data-astro-cid-v6ggcyrl> <span class="icon" data-astro-cid-v6ggcyrl>‚ò∞</span> </button> </div> <!-- Modal Overlay Menu --> <div id="pdf-menu-overlay" class="pdf-menu-overlay" style="display: none;" data-astro-cid-v6ggcyrl> <div class="pdf-menu-modal" data-astro-cid-v6ggcyrl> <div class="menu-header" data-astro-cid-v6ggcyrl> <h3 class="menu-title" data-astro-cid-v6ggcyrl>üìñ PDF Viewer Options</h3> <button id="menu-close-btn" class="menu-close-btn" data-astro-cid-v6ggcyrl>&times;</button> </div> <div class="menu-content" data-astro-cid-v6ggcyrl> <div class="menu-section" data-astro-cid-v6ggcyrl> <h4 class="menu-section-title" data-astro-cid-v6ggcyrl>üìö How to Use</h4> <div class="menu-info" data-astro-cid-v6ggcyrl> <p data-astro-cid-v6ggcyrl>Use the controls below to navigate through the PDF document.</p> <ul data-astro-cid-v6ggcyrl> <li data-astro-cid-v6ggcyrl>üñ±Ô∏è Use Previous/Next buttons to navigate pages</li> <li data-astro-cid-v6ggcyrl>üîç Use +/- buttons to zoom in and out</li> <li data-astro-cid-v6ggcyrl>üì± Click page number to jump to specific page</li> <li data-astro-cid-v6ggcyrl>‚õ∂ Use fullscreen button for immersive reading</li> </ul> </div> </div> </div> </div> </div> </div> <script>(function(){const pdfjsWorkerSrc = "/pdf.worker.min.mjs";

  // --- State Management ---
  let currentPdfDoc = null;
  let currentPageNum = 1;
  let currentScale = 1.5;
  let totalPages = 0;
  let activePdfUrl = ''; // This will be updated on each page load
  let handlers = {}; // To store event listener references for cleanup

  // --- Core Lifecycle Functions ---

  async function initializePdfViewer() {
    console.log('üöÄ Starting PDF viewer initialization...');
    const spinner = document.querySelector('.loading-spinner');
    if (spinner) spinner.style.display = 'block';

    try {
      await waitForRequiredElements();
      await loadPdf();
      setupEventListeners();
      setupKeyboardShortcuts();
      console.log('‚úÖ PDF viewer initialization complete');
    } catch (error) {
      console.error('‚ùå Initialization failed:', error);
      const canvasWrapper = document.querySelector('.canvas-wrapper');
      if (canvasWrapper) {
        canvasWrapper.innerHTML = `<div style="padding: 20px; text-align: center; color: #721c24; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px;">
          <h3>‚ùå PDF Viewer Initialization Failed</h3>
          <p>Error: ${error.message}</p>
        </div>`;
      }
    } finally {
      if (spinner) spinner.style.display = 'none';
    }
  }

  function cleanup() {
    console.log('Cleaning up PDF viewer instance...');
    removeEventListeners();
    if (currentPdfDoc) {
      console.log('Destroying previous PDF document instance.');
      currentPdfDoc.destroy();
      currentPdfDoc = null;
    }
    currentPageNum = 1;
    totalPages = 0;
    currentScale = 1.5;
  }

  function setupViewer() {
    const container = document.getElementById('pdf-viewer-container');
    if (container) {
      activePdfUrl = container.dataset.pdfUrl;
      console.log(`PDF Viewer container found for ${activePdfUrl}, running setup...`);
      cleanup();
      initializePdfViewer();
    } else {
      console.log('No PDF viewer on this page, cleaning up old listeners.');
      cleanup();
    }
  }

  // --- Astro Lifecycle Hook ---

  if (!window.astroPdfViewerListenerAttached) {
    console.log('Attaching astro:page-load listener.');
    document.addEventListener('astro:page-load', setupViewer);
    window.astroPdfViewerListenerAttached = true;
  }

  // Initial run for the very first page load.
  setupViewer();

  // --- Event Listener Management ---

  function addListener(id, element, event, handler) {
    if (element) {
      element.addEventListener(event, handler);
      handlers[id] = { element, event, handler };
    }
  }

  function removeEventListeners() {
    console.log(`Removing ${Object.keys(handlers).length} event listeners.`);
    Object.values(handlers).forEach(({ element, event, handler }) => {
      if (element) element.removeEventListener(event, handler);
    });
    handlers = {};
  }

  function setupEventListeners() {
    console.log('üîß Setting up event listeners...');
    addListener('prevPage', document.getElementById('prev-page'), 'click', onPrevPage);
    addListener('nextPage', document.getElementById('next-page'), 'click', onNextPage);
    addListener('zoomIn', document.getElementById('zoom-in'), 'click', onZoomIn);
    addListener('zoomOut', document.getElementById('zoom-out'), 'click', onZoomOut);
    addListener('fullscreen', document.getElementById('fullscreen-btn'), 'click', toggleFullscreen);
    addListener('docFullscreenChange', document, 'fullscreenchange', onFullscreenChange);
    addListener('menuBtn', document.getElementById('menu-btn'), 'click', toggleMenu);
    addListener('menuCloseBtn', document.getElementById('menu-close-btn'), 'click', toggleMenu);
    addListener('pageIndicator', document.getElementById('page-indicator'), 'click', togglePageInput);
    addListener('gotoPageBtn', document.getElementById('goto-page-btn'), 'click', gotoPage);
    addListener('pageInputEnter', document.getElementById('page-input'), 'keypress', (e) => e.key === 'Enter' && gotoPage());
  }

  function setupKeyboardShortcuts() {
    addListener('keyboard', document, 'keydown', (event) => {
      if (event.target.tagName === 'INPUT') return;
      switch(event.key) {
        case 'ArrowLeft': onPrevPage(); break;
        case 'ArrowRight': onNextPage(); break;
        case 'f': toggleFullscreen(); break;
      }
    });
  }

  // --- PDF & Rendering Logic ---

  async function loadPdf() {
    if (!activePdfUrl) throw new Error('PDF URL is not set.');
    console.log('Loading PDF:', activePdfUrl);
    const pdfjsLib = await import('/pdf.min.mjs');
    pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorkerSrc;

    const loadingTask = pdfjsLib.getDocument(activePdfUrl);
    currentPdfDoc = await loadingTask.promise;
    totalPages = currentPdfDoc.numPages;
    console.log(`PDF loaded successfully: ${totalPages} pages`);

    document.getElementById('page-count-display').textContent = totalPages;
    document.getElementById('page-input').max = totalPages;
    
    const savedPage = loadReadingProgress();
    currentPageNum = (savedPage && savedPage <= totalPages) ? savedPage : 1;
    
    await renderPage(currentPageNum);
    updateZoomLevelDisplay();
  }

  async function renderPage(num, scale = null) {
    if (!currentPdfDoc) return;
    if (num < 1 || num > totalPages) return;

    currentScale = scale || currentScale;
    console.log(`Rendering page ${num} at scale ${currentScale}`);

    const page = await currentPdfDoc.getPage(num);
    const viewport = page.getViewport({ scale: currentScale });
    const canvasWrapper = document.querySelector('.canvas-wrapper');
    if (!canvasWrapper) return;

    const oldCanvas = document.getElementById('pdf-canvas');
    if (oldCanvas) oldCanvas.remove();

    const canvas = document.createElement('canvas');
    canvas.id = 'pdf-canvas';
    const devicePixelRatio = window.devicePixelRatio || 1;
    canvas.width = viewport.width * devicePixelRatio;
    canvas.height = viewport.height * devicePixelRatio;
    canvas.style.width = `${viewport.width}px`;
    canvas.style.height = `${viewport.height}px`;
    canvas.style.display = 'inline-block';
    canvasWrapper.appendChild(canvas);

    const ctx = canvas.getContext('2d');
    ctx.scale(devicePixelRatio, devicePixelRatio);

    await page.render({ canvasContext: ctx, viewport }).promise;
    console.log(`‚úÖ Successfully rendered page ${num}`);

    currentPageNum = num;
    document.getElementById('page-num-display').textContent = num;
    saveReadingProgress(num);
    canvasWrapper.scrollTop = 0;
  }

  // --- UI Handlers & Helpers ---

  function onPrevPage() { if (currentPageNum > 1) renderPage(currentPageNum - 1); }
  function onNextPage() { if (currentPageNum < totalPages) renderPage(currentPageNum + 1); }
  function onZoomIn() { renderPage(currentPageNum, currentScale + 0.25); updateZoomLevelDisplay(); }
  function onZoomOut() { if (currentScale > 0.25) { renderPage(currentPageNum, currentScale - 0.25); updateZoomLevelDisplay(); } }

  function toggleFullscreen() {
    const viewer = document.getElementById('pdf-viewer-container');
    if (!document.fullscreenElement) viewer.requestFullscreen().catch(err => console.error(err));
    else document.exitFullscreen();
  }

  function onFullscreenChange() {
    const btn = document.getElementById('fullscreen-btn');
    if (!btn) return;
    const isFullscreen = !!document.fullscreenElement;
    btn.querySelector('.icon').innerHTML = isFullscreen ? '&#x2923;' : '&#x2922;';
    btn.title = isFullscreen ? 'Exit Fullscreen' : 'Toggle Fullscreen';
  }

  function toggleMenu() {
    const menuOverlay = document.getElementById('pdf-menu-overlay');
    if (menuOverlay) menuOverlay.style.display = menuOverlay.style.display === 'none' ? 'flex' : 'none';
  }

  function togglePageInput() {
    document.getElementById('page-navigation-group').style.display = 'block';
    document.getElementById('page-indicator').style.display = 'none';
  }

  function gotoPage() {
    const pageInput = document.getElementById('page-input');
    const pageNum = parseInt(pageInput.value, 10);
    if (!isNaN(pageNum) && pageNum >= 1 && pageNum <= totalPages) renderPage(pageNum);
    pageInput.value = '';
    document.getElementById('page-navigation-group').style.display = 'none';
    document.getElementById('page-indicator').style.display = 'flex';
  }

  function updateZoomLevelDisplay() {
    document.getElementById('zoom-level').textContent = `${Math.round(currentScale * 100)}%`;
  }

  function saveReadingProgress(page) {
    if (!activePdfUrl) return;
    try { localStorage.setItem(activePdfUrl, page.toString()); } catch (e) { console.warn(e); }
  }

  function loadReadingProgress() {
    if (!activePdfUrl) return null;
    try { return parseInt(localStorage.getItem(activePdfUrl), 10) || null; } catch (e) { return null; }
  }

  async function waitForRequiredElements() {
    const selectors = ['#page-count-display', '#page-input', '#page-num-display'];
    let attempts = 0;
    while (attempts < 50) {
      if (selectors.every(s => document.querySelector(s))) return;
      await new Promise(res => setTimeout(res, 100));
      attempts++;
    }
    throw new Error('Required UI elements did not appear in time.');
  }
})();</script>  </div>  </article>  </div> </main> </div> <footer data-astro-cid-sz7xmlte> <div class="footer-container library-page-footer" data-astro-cid-sz7xmlte> <div class="footer-columns" data-astro-cid-sz7xmlte> <div class="column" data-astro-cid-sz7xmlte> <h5 data-astro-cid-sz7xmlte>Menu</h5> <ul data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte><a href="/" data-astro-cid-sz7xmlte>Home</a></li> <li data-astro-cid-sz7xmlte><a href="/library/" data-astro-cid-sz7xmlte>Library</a></li> <li data-astro-cid-sz7xmlte><a href="/about/" data-astro-cid-sz7xmlte>About</a></li> <li data-astro-cid-sz7xmlte><a href="/contact/" data-astro-cid-sz7xmlte>Contact</a></li> </ul> </div> <div class="column" data-astro-cid-sz7xmlte> <h5 data-astro-cid-sz7xmlte>References</h5> <ul data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte><a href="https://yourwebsite.com" target="_blank" data-astro-cid-sz7xmlte>Your Website</a></li> <li data-astro-cid-sz7xmlte><a href="/privacy-policy/" data-astro-cid-sz7xmlte>Privacy Policy</a></li> <li data-astro-cid-sz7xmlte><a href="/terms-conditions/" data-astro-cid-sz7xmlte>Terms and Conditions</a></li> <li data-astro-cid-sz7xmlte><a href="/social/" data-astro-cid-sz7xmlte>Social Links</a></li> </ul> </div> </div> <div class="copyright" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>&copy; 2025 [Your Organization]. All rights reserved.</p> </div> </div></footer>  <script>
  function initializeSidebar() {
    const sidebarToggle = document.querySelector('.sidebar-toggle');
    const sidebar = document.getElementById('sidebar'); // ID is in Sidebar.astro
    const body = document.body;

    if (sidebarToggle && sidebar) {
      // Remove existing listeners by cloning the element
      const newSidebarToggle = sidebarToggle.cloneNode(true);
      sidebarToggle.parentNode.replaceChild(newSidebarToggle, sidebarToggle);
      
      newSidebarToggle.addEventListener('click', () => {
        const isExpanded = newSidebarToggle.getAttribute('aria-expanded') === 'true' || false;
        newSidebarToggle.setAttribute('aria-expanded', String(!isExpanded));
        sidebar.classList.toggle('is-active');
        newSidebarToggle.classList.toggle('is-active');
        // Uncomment below to use body overlay
        // body.classList.toggle('sidebar-open-overlay');
      });
    }

    // Remove existing click listener and add new one
    const existingClickHandler = window.sidebarClickHandler;
    if (existingClickHandler) {
      document.removeEventListener('click', existingClickHandler);
    }

    // Optional: Close sidebar if user clicks outside of it on mobile
    window.sidebarClickHandler = function(event) {
      const currentSidebar = document.getElementById('sidebar');
      const currentSidebarToggle = document.querySelector('.sidebar-toggle');
      
      if (currentSidebar && currentSidebarToggle && currentSidebar.classList.contains('is-active')) {
        const isClickInsideSidebar = currentSidebar.contains(event.target);
        const isClickOnToggler = currentSidebarToggle.contains(event.target);

        if (!isClickInsideSidebar && !isClickOnToggler) {
          currentSidebar.classList.remove('is-active');
          currentSidebarToggle.classList.remove('is-active');
          currentSidebarToggle.setAttribute('aria-expanded', 'false');
          // Uncomment below to use body overlay
          // body.classList.remove('sidebar-open-overlay');
        }
      }
    };
    
    document.addEventListener('click', window.sidebarClickHandler);
  }

  // Initialize on page load
  initializeSidebar();

  // Reinitialize after view transitions
  document.addEventListener('astro:page-load', initializeSidebar);
</script> </body> </html>  